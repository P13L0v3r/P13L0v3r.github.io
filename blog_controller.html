<!DOCTYPE html>
<html>
    <head>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
        <script
            type="module"
            src="https://md-block.verou.me/md-block.js"
        ></script>
        <link rel="stylesheet" href="../style.css" />
        <title>Hugo's Portfolio</title>
        <script>
            function getBlogs(callback) {
                fetch(
                    "https://api.github.com/repos/P13L0v3r/P13L0v3r.github.io/contents/blogs/"
                ).then((r) => {
                    r.json().then((files) => callback(files));
                });
            }
            function fetchLastModified(path, callback) {
                console.log(
                    `https://api.github.com/repos/P13L0v3r/P13L0v3r.github.io/commits?path=${path}`
                );
                fetch(
                    `https://api.github.com/repos/P13L0v3r/P13L0v3r.github.io/commits?path=${path}`
                ).then((r) => {
                    r.json().then((commits) =>
                        callback(commits[0].commit.committer.date)
                    );
                });
            }

            getBlogs((files) => {
                console.log(files);
                for (file in files) {
                    console.log(files[file]);
                    fetchLastModified(files[file].path, (date) => {
                        var post = `<div class="blog-post centered hide-until-load neumorphic"><md-block src="${files[file].path}" rendered="remote">This post wasn't found.</md-block><footer>Last Edited: ${date}</footer></div>`;
                        $("body").append(post);
                        console.log(date);
                    });
                }
            });

            $(document).ready(function () {
                $(".hide-until-load").show();
            });
        </script>
    </head>

    <body>
        <!-- Here is a template for creating blog posts -->
        <div class="blog-post centered hide-until-load neumorphic">
            <md-block src="blogs/hello_blog.md" rendered="remote">
                This post wasn't found.
            </md-block>
            <footer>Last Edited: April 13, 2024</footer>
        </div>
    </body>
</html>
